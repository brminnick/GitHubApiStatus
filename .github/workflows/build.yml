name: Build Projects

on:
  push:
    branches:
      - "main"
  pull_request:
    branches: 
      - "*"

jobs:
  Android:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1

    - name: Setup .NET v6.0
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Install Boots
      run : |
        dotnet tool install --global boots --prerelease
        boots --alpha Mono
        boots --alpha Xamarin.Android
      
    - name: Print Build Info
      run : |
        msbuild --version
        dotnet --info
    - name: Build Android App
      run: |
        AndroidProject=`find . -name GitStatus.Android.csproj`
        echo $AndroidProject

        AndroidProjectDirectory=`dirname $AndroidProject`
        echo $AndroidProjectDirectory
        
        msbuild $AndroidProjectDirectory /verbosity:normal /p:Configuration=Release /restore

  API:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1

    - name: Setup .NET v6.0
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Build API App
      run: |
        APIProject=`find . -name GitStatus.API.csproj`
        echo $APIProject

        APIProjectDirectory=`dirname $APIProject`
        echo $APIProjectDirectory
        
        dotnet build -c Release $APIProjectDirectory

  Console:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1

    - name: Setup .NET v6.0
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Build Console App
      run: |        
        ConsoleProject=`find . -name GitStatus.ConsoleApp.csproj`
        echo $ConsoleProject

        ConsoleProjectDirectory=`dirname $ConsoleProject`
        echo $ConsoleProjectDirectory

        dotnet build -c Release $ConsoleProjectDirectory

  Web:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1

    - name: Setup .NET v6.0
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Build Web App
      run: |                   
        WebProject=`find . -name GitStatus.Web.csproj`
        echo $WebProject

        WebProjectDirectory=`dirname $WebProject`
        echo $WebProjectDirectory

        dotnet build -c Release $WebProjectDirectory

  GitHubApiStatus:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1

    - name: Setup .NET v6.0
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.0.x'

    - name: Build Web App
      run: |                  
        GitHubApiStatusExtensionsProject=`find . -name GitHubApiStatus.Extensions.csproj`
        echo $GitHubApiStatusExtensionsProject

        GitHubApiStatusExtensionsProjectDirectory=`dirname $GitHubApiStatusExtensionsProject`
        echo $GitHubApiStatusExtensionsProjectDirectory
  
        dotnet build -c Release $GitHubApiStatusExtensionsProjectDirectory
